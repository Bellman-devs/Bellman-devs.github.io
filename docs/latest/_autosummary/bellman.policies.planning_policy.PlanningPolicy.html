

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>bellman.policies.planning_policy.PlanningPolicy &mdash; Bellman 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/color_theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="bellman.training" href="bellman.training.html" />
    <link rel="prev" title="bellman.policies.planning_policy" href="bellman.policies.planning_policy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Bellman
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Jupyter Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/approximate_mdps.html">Approximating MDPs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/model_visualisation.html">Learning from samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/trajectory_optimisation.html">Trajectory Optimisation</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="bellman.html">bellman</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bellman.agents.html">bellman.agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.benchmark.html">bellman.benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.distributions.html">bellman.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.drivers.html">bellman.drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.environments.html">bellman.environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.harness.html">bellman.harness</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.networks.html">bellman.networks</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="bellman.policies.html">bellman.policies</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bellman.policies.cross_entropy_method_policy.html">bellman.policies.cross_entropy_method_policy</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="bellman.policies.planning_policy.html">bellman.policies.planning_policy</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">bellman.policies.planning_policy.PlanningPolicy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bellman.training.html">bellman.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="bellman.trajectory_optimisers.html">bellman.trajectory_optimisers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bellman</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="bellman.html">bellman</a> &raquo;</li>
        
          <li><a href="bellman.policies.html">bellman.policies</a> &raquo;</li>
        
          <li><a href="bellman.policies.planning_policy.html">bellman.policies.planning_policy</a> &raquo;</li>
        
      <li>bellman.policies.planning_policy.PlanningPolicy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="bellman-policies-planning-policy-planningpolicy">
<h1>bellman.policies.planning_policy.PlanningPolicy<a class="headerlink" href="#bellman-policies-planning-policy-planningpolicy" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="bellman.policies.planning_policy.PlanningPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">bellman.policies.planning_policy.</span></code><code class="sig-name descname"><span class="pre">PlanningPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">environment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory_optimiser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emit_log_probability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_state_reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_and_action_constraint_splitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bellman/policies/planning_policy.html#PlanningPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tf_agents.policies.tf_policy.TFPolicy</span></code></p>
<p>Planning policies take a model of the environment and use it to sample virtual
trajectories, which are used to select the optimal action at the current state. Note that
the computational burden, compared to a parametric policy, is high.</p>
<p>Note that for simulating multiple rollouts in the environment we use batches as set by a
<cite>batch_size</cite> parameter. This is in fact the <cite>population_size</cite> parameter common to most
trajectory optimizers. This class makes sure that <cite>batch_size</cite> is set according to
<cite>population_size</cite> parameter.</p>
<p>Initializes the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>environment_model</strong> (<a class="reference internal" href="bellman.environments.environment_model.EnvironmentModel.html#bellman.environments.environment_model.EnvironmentModel" title="bellman.environments.environment_model.EnvironmentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvironmentModel</span></code></a>) – An <cite>EnvironmentModel</cite> is a model of the MDP that represents
the environment, consisting of a transition, reward, termination and initial state
distribution model, of which some are trainable and some are fixed.</p></li>
<li><p><strong>trajectory_optimiser</strong> (<a class="reference internal" href="bellman.trajectory_optimisers.trajectory_optimisers.TrajectoryOptimiser.html#bellman.trajectory_optimisers.trajectory_optimisers.TrajectoryOptimiser" title="bellman.trajectory_optimisers.trajectory_optimisers.TrajectoryOptimiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryOptimiser</span></code></a>) – A <cite>TrajectoryOptimiser</cite> takes an environment model and
optimises a sequence of actions over a given horizon using virtual rollouts.</p></li>
<li><p><strong>clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to clip actions to spec before returning them. By default True.</p></li>
<li><p><strong>emit_log_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Emit log-probabilities of actions, if supported. If
True, policy_step.info will have CommonFields.LOG_PROBABILITY set.
Please consult utility methods provided in policy_step for setting and
retrieving these. When working with custom policies, either provide a
dictionary info_spec or a namedtuple with the field ‘log_probability’.</p></li>
<li><p><strong>automatic_state_reset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <cite>True</cite>, then <cite>get_initial_policy_state</cite> is used
to clear state in <cite>action()</cite> and <cite>distribution()</cite> for for time steps
where <cite>time_step.is_first()</cite>.</p></li>
<li><p><strong>observation_and_action_constraint_splitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]]]]) – <p>A function used to process
observations with action constraints. These constraints can indicate,
for example, a mask of valid/invalid actions for a given state of the
environment. The function takes in a full observation and returns a
tuple consisting of 1) the part of the observation intended as input to
the network and 2) the constraint. An example
<cite>observation_and_action_constraint_splitter</cite> could be as simple as: <a href="#id1"><span class="problematic" id="id2">``</span></a>`
def observation_and_action_constraint_splitter(observation): return</p>
<blockquote>
<div><p>observation[‘network_input’], observation[‘constraint’] <a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
</div></blockquote>
<dl class="simple">
<dt><em>Note</em>: when using <cite>observation_and_action_constraint_splitter</cite>, make</dt><dd><p>sure the provided <cite>q_network</cite> is compatible with the network-specific
half of the output of the
<cite>observation_and_action_constraint_splitter</cite>. In particular,
<cite>observation_and_action_constraint_splitter</cite> will be called on the
observation before passing to the network. If
<cite>observation_and_action_constraint_splitter</cite> is None, action
constraints are not applied.</p>
</dd>
</dl>
</p></li>
<li><p><strong>validate_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Python bool.  Whether to verify inputs to, and outputs of,
functions like <cite>action</cite> and <cite>distribution</cite> against spec structures,
dtypes, and shapes. Research code may prefer to set this value to <cite>False</cite>
to allow iterating on input and output structures without being hamstrung
by overly rigid checking (at the cost of harder-to-debug errors). See also
<cite>TFAgent.validate_args</cite>.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A name for this module. Defaults to the class name.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.action" title="bellman.policies.planning_policy.PlanningPolicy.action"><code class="xref py py-obj docutils literal notranslate"><span class="pre">action</span></code></a></p></td>
<td><p>Generates next action given the time_step and policy_state.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.distribution" title="bellman.policies.planning_policy.PlanningPolicy.distribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distribution</span></code></a></p></td>
<td><p>Generates the distribution over next actions given the time_step.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.get_initial_state" title="bellman.policies.planning_policy.PlanningPolicy.get_initial_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_initial_state</span></code></a></p></td>
<td><p>Returns an initial state usable by the policy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.update" title="bellman.policies.planning_policy.PlanningPolicy.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a></p></td>
<td><p>Update the current policy with another policy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.variables" title="bellman.policies.planning_policy.PlanningPolicy.variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></a></p></td>
<td><p>Returns the list of Variables that belong to the policy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.with_name_scope" title="bellman.policies.planning_policy.PlanningPolicy.with_name_scope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">with_name_scope</span></code></a></p></td>
<td><p>Decorator to automatically enter the module name scope.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.action_spec" title="bellman.policies.planning_policy.PlanningPolicy.action_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">action_spec</span></code></a></p></td>
<td><p>Describes the TensorSpecs of the Tensors expected by <cite>step(action)</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.collect_data_spec" title="bellman.policies.planning_policy.PlanningPolicy.collect_data_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_data_spec</span></code></a></p></td>
<td><p>Describes the Tensors written when using this policy with an environment.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.emit_log_probability" title="bellman.policies.planning_policy.PlanningPolicy.emit_log_probability"><code class="xref py py-obj docutils literal notranslate"><span class="pre">emit_log_probability</span></code></a></p></td>
<td><p>Whether this policy instance emits log probabilities or not.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.info_spec" title="bellman.policies.planning_policy.PlanningPolicy.info_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info_spec</span></code></a></p></td>
<td><p>Describes the Tensors emitted as info by <cite>action</cite> and <cite>distribution</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.name" title="bellman.policies.planning_policy.PlanningPolicy.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p>Returns the name of this module as passed or determined in the ctor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.name_scope" title="bellman.policies.planning_policy.PlanningPolicy.name_scope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name_scope</span></code></a></p></td>
<td><p>Returns a <cite>tf.name_scope</cite> instance for this class.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">observation_and_action_constraint_splitter</span></code></p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]]]]</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.policy_state_spec" title="bellman.policies.planning_policy.PlanningPolicy.policy_state_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">policy_state_spec</span></code></a></p></td>
<td><p>Describes the Tensors expected by <cite>step(_, policy_state)</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.policy_step_spec" title="bellman.policies.planning_policy.PlanningPolicy.policy_step_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">policy_step_spec</span></code></a></p></td>
<td><p>Describes the output of <cite>action()</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.submodules" title="bellman.policies.planning_policy.PlanningPolicy.submodules"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submodules</span></code></a></p></td>
<td><p>Sequence of all sub-modules.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.time_step_spec" title="bellman.policies.planning_policy.PlanningPolicy.time_step_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_step_spec</span></code></a></p></td>
<td><p>Describes the <cite>TimeStep</cite> tensors returned by <cite>step()</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.trainable_variables" title="bellman.policies.planning_policy.PlanningPolicy.trainable_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></a></p></td>
<td><p>Sequence of trainable variables owned by this module and its submodules.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.trajectory_spec" title="bellman.policies.planning_policy.PlanningPolicy.trajectory_spec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trajectory_spec</span></code></a></p></td>
<td><p>Describes the Tensors written when using this policy with an environment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#bellman.policies.planning_policy.PlanningPolicy.validate_args" title="bellman.policies.planning_policy.PlanningPolicy.validate_args"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate_args</span></code></a></p></td>
<td><p>Whether <cite>action</cite> &amp; <cite>distribution</cite> validate input and output args.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.action">
<code class="sig-name descname"><span class="pre">action</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.action" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates next action given the time_step and policy_state.</p>
<dl>
<dt>Args:</dt><dd><p>time_step: A <cite>TimeStep</cite> tuple corresponding to <cite>time_step_spec()</cite>.
policy_state: A Tensor, or a nested dict, list or tuple of Tensors</p>
<blockquote>
<div><p>representing the previous policy_state.</p>
</div></blockquote>
<p>seed: Seed to use if action performs sampling (optional).</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>A <cite>PolicyStep</cite> named tuple containing:</dt><dd><p><cite>action</cite>: An action Tensor matching the <cite>action_spec</cite>.
<cite>state</cite>: A policy state tensor to be fed into the next call to action.
<cite>info</cite>: Optional side information such as action log probabilities.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><p>RuntimeError: If subclass __init__ didn’t call super().__init__.
ValueError or TypeError: If <cite>validate_args is True</cite> and inputs or</p>
<blockquote>
<div><p>outputs do not match <cite>time_step_spec</cite>, <cite>policy_state_spec</cite>,
or <cite>policy_step_spec</cite>.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PolicyStep</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.action_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">action_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.action_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the TensorSpecs of the Tensors expected by <cite>step(action)</cite>.</p>
<p><cite>action</cite> can be a single Tensor, or a nested dict, list or tuple of
Tensors.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>An single BoundedTensorSpec, or a nested dict, list or tuple of
<cite>BoundedTensorSpec</cite> objects, which describe the shape and
dtype of each Tensor expected by <cite>step()</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.collect_data_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">collect_data_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.collect_data_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the Tensors written when using this policy with an environment.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A nest of TensorSpec which describe the shape and dtype of each Tensor
required to train the agent which generated this policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.distribution">
<code class="sig-name descname"><span class="pre">distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the distribution over next actions given the time_step.</p>
<dl>
<dt>Args:</dt><dd><p>time_step: A <cite>TimeStep</cite> tuple corresponding to <cite>time_step_spec()</cite>.
policy_state: A Tensor, or a nested dict, list or tuple of Tensors</p>
<blockquote>
<div><p>representing the previous policy_state.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>A <cite>PolicyStep</cite> named tuple containing:</p>
<blockquote>
<div><p><cite>action</cite>: A tf.distribution capturing the distribution of next actions.
<cite>state</cite>: A policy state tensor for the next call to distribution.
<cite>info</cite>: Optional side information such as action log probabilities.</p>
</div></blockquote>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError or TypeError: If <cite>validate_args is True</cite> and inputs or</dt><dd><p>outputs do not match <cite>time_step_spec</cite>, <cite>policy_state_spec</cite>,
or <cite>policy_step_spec</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PolicyStep</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.emit_log_probability">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">emit_log_probability</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.emit_log_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this policy instance emits log probabilities or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.get_initial_state">
<code class="sig-name descname"><span class="pre">get_initial_state</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.get_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an initial state usable by the policy.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>batch_size: Tensor or constant: size of the batch dimension. Can be None</dt><dd><p>in which case no dimensions gets added.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A nested object of type <cite>policy_state</cite> containing properly
initialized Tensors.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensor</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.info_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">info_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.info_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the Tensors emitted as info by <cite>action</cite> and <cite>distribution</cite>.</p>
<p><cite>info</cite> can be an empty tuple, a single Tensor, or a nested dict,
list or tuple of Tensors.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>An single TensorSpec, or a nested dict, list or tuple of
<cite>TensorSpec</cite> objects, which describe the shape and
dtype of each Tensor expected by <cite>step(_, policy_state)</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.name">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">name</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of this module as passed or determined in the ctor.</p>
<p>NOTE: This is not the same as the <cite>self.name_scope.name</cite> which includes
parent module names.</p>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.name_scope">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">name_scope</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.name_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>tf.name_scope</cite> instance for this class.</p>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.policy_state_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">policy_state_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.policy_state_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the Tensors expected by <cite>step(_, policy_state)</cite>.</p>
<p><cite>policy_state</cite> can be an empty tuple, a single Tensor, or a nested dict,
list or tuple of Tensors.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>An single TensorSpec, or a nested dict, list or tuple of
<cite>TensorSpec</cite> objects, which describe the shape and
dtype of each Tensor expected by <cite>step(_, policy_state)</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RaggedTensorSpec</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">SparseTensorSpec</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.policy_step_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">policy_step_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.policy_step_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the output of <cite>action()</cite>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A nest of TensorSpec which describe the shape and dtype of each Tensor
emitted by <cite>action()</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PolicyStep</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.submodules">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">submodules</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.submodules" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of all sub-modules.</p>
<p>Submodules are modules which are properties of this module, or found as
properties of modules which are properties of this module (and so on).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">submodules</span><span class="p">)</span> <span class="o">==</span> <span class="p">[]</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="simple">
<dt>Returns:</dt><dd><p>A sequence of all submodules.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.time_step_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">time_step_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.time_step_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the <cite>TimeStep</cite> tensors returned by <cite>step()</cite>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A <cite>TimeStep</cite> namedtuple with <cite>TensorSpec</cite> objects instead of Tensors,
which describe the shape, dtype and name of each tensor returned by
<cite>step()</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStep</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.trainable_variables">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">trainable_variables</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.trainable_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of trainable variables owned by this module and its submodules.</p>
<p>Note: this method uses reflection to find variables on the current instance
and submodules. For performance reasons you may wish to cache the result
of calling this method if you don’t expect the return value to change.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A sequence of variables for the current module (sorted by attribute
name) followed by variables from all submodules recursively (breadth
first).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.trajectory_spec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">trajectory_spec</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.trajectory_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the Tensors written when using this policy with an environment.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A <cite>Trajectory</cite> containing all tensor specs associated with the
observation_spec, action_spec, policy_state_spec, and info_spec of
this policy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_non_trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_variables_by_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the current policy with another policy.</p>
<p>This would include copying the variables from the other policy.</p>
<dl>
<dt>Args:</dt><dd><p>policy: Another policy it can update from.
tau: A float scalar in [0, 1]. When tau is 1.0 (the default), we do a hard</p>
<blockquote>
<div><p>update. This is used for trainable variables.</p>
</div></blockquote>
<dl class="simple">
<dt>tau_non_trainable: A float scalar in [0, 1] for non_trainable variables.</dt><dd><p>If None, will copy from tau.</p>
</dd>
<dt>sort_variables_by_name: A bool, when True would sort the variables by name</dt><dd><p>before doing the update.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>An TF op to do the update.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Operation</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.validate_args">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">validate_args</span></code><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.validate_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether <cite>action</cite> &amp; <cite>distribution</cite> validate input and output args.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.variables">
<code class="sig-name descname"><span class="pre">variables</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of Variables that belong to the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="bellman.policies.planning_policy.PlanningPolicy.with_name_scope">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">with_name_scope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bellman.policies.planning_policy.PlanningPolicy.with_name_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to automatically enter the module name scope.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nd">@tf</span><span class="o">.</span><span class="n">Module</span><span class="o">.</span><span class="n">with_name_scope</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">):</span>
<span class="gp">... </span>      <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span><span class="p">]))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the above module would produce <a href="#id7"><span class="problematic" id="id8">`</span></a>tf.Variable`s and <a href="#id9"><span class="problematic" id="id10">`</span></a>tf.Tensor`s whose
names included the module name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">MyModule</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">&lt;tf.Tensor: shape=(1, 3), dtype=float32, numpy=..., dtype=float32)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">w</span>
<span class="go">&lt;tf.Variable &#39;my_module/Variable:0&#39; shape=(2, 3) dtype=float32,</span>
<span class="go">numpy=..., dtype=float32)&gt;</span>
</pre></div>
</div>
<dl class="simple">
<dt>Args:</dt><dd><p>method: The method to wrap.</p>
</dd>
<dt>Returns:</dt><dd><p>The original method wrapped such that it enters the module’s name scope.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="bellman.training.html" class="btn btn-neutral float-right" title="bellman.training" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="bellman.policies.planning_policy.html" class="btn btn-neutral float-left" title="bellman.policies.planning_policy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, The Bellman Contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>